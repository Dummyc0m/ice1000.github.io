<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0052)http://www.iwesoft.com/ -->
<html>
<head>
<title>pg_0001</title>

<style>
<!-- 
select {font-size:12px;}
A:link {text-decoration: none; color: blue}
A:visited {text-decoration: none; color: purple}
A:active {text-decoration: red}
A:hover {text-decoration: underline; color:red}
-->
</style>
<script TYPE="text/javascript"> 
<!-- hide 
function killerrors()
{ 
return true; 
} 
window.onerror = killerrors; 
// --> 
</script>
<style type="text/css">
<!--
.ft0{font-style:normal;font-weight:bold;font-size:30px;font-family:Calibri;color:#000000;}
.ft1{font-style:normal;font-weight:normal;font-size:30px;font-family:;color:#000000;}
.ft2{font-style:normal;font-weight:normal;font-size:19px;font-family:;color:#000000;}
.ft3{font-style:normal;font-weight:bold;font-size:19px;font-family:Calibri;color:#000000;}
.ft4{font-style:normal;font-weight:normal;font-size:16px;font-family:;color:#000000;}
.ft5{font-style:normal;font-weight:normal;font-size:16px;font-family:Calibri;color:#9876aa;}
.ft6{font-style:normal;font-weight:normal;font-size:16px;font-family:Calibri;color:#a9b7c6;}
.ft7{font-style:italic;font-weight:normal;font-size:16px;font-family:Calibri;color:#9876aa;}
.ft8{font-style:normal;font-weight:normal;font-size:16px;font-family:Calibri;color:#cc7832;}
.ft9{font-style:normal;font-weight:normal;font-size:16px;font-family:Calibri;color:#e8bf6a;}
.ft10{font-style:normal;font-weight:normal;font-size:16px;font-family:Calibri;color:#bababa;}
.ft11{font-style:normal;font-weight:normal;font-size:16px;font-family:Calibri;color:#6a8759;}
-->
</style>
</head>
<body vlink="#FFFFFF" link="#FFFFFF" bgcolor="#ffffff">

<script TYPE="text/javascript">
var currentpos,timer; 
function initialize() 
{ 
timer=setInterval("scrollwindow()",10);
} 
function sc(){
clearInterval(timer); 
}
function scrollwindow() 
{ 
currentpos=document.body.scrollTop; 
window.scroll(0,++currentpos); 
if (currentpos != document.body.scrollTop) 
sc();
} 
document.onmousedown=sc
document.ondblclick=initialize
</script>
<div style="position:absolute;top:0;left:0"><img width="827" height="1169" src="pg_0001.jpg" ALT=""></div>
<div style="position:absolute;top:128;left:125"><span class="ft0">Android</span></div>
<div style="position:absolute;top:128;left:235"><span class="ft1">开发中使用</span></div>
<div style="position:absolute;top:128;left:396"><span class="ft0">RecyclerView</span></div>
<div style="position:absolute;top:128;left:572"><span class="ft1">实现聊天</span></div>
<div style="position:absolute;top:171;left:230"><span class="ft0">APP</span></div>
<div style="position:absolute;top:171;left:289"><span class="ft1">消息框左右对齐的效果</span></div>
<div style="position:absolute;top:232;left:553"><span class="ft2">张寅森</span></div>
<div style="position:absolute;top:232;left:611"><span class="ft3">(</span></div>
<div style="position:absolute;top:232;left:617"><span class="ft2">千里冰封</span></div>
<div style="position:absolute;top:232;left:695"><span class="ft3">)</span></div>
<div style="position:absolute;top:256;left:158"><span class="ft4">像QQ、微信、短信等聊天APP的聊天&frac12;面中，都有一个特征，就是用户</span></div>
<div style="position:absolute;top:277;left:125"><span class="ft4">发送的消息呈现在右边，其他消息在左边。这个效果可以十分简单地通过</span></div>
<div style="position:absolute;top:298;left:125"><span class="ft4">Android中v7包里的RecyclerView实现。</span></div>
<div style="position:absolute;top:319;left:158"><span class="ft4">RecyclerView本身高度&frac12;耦，&frac12;大多数操作&frac12;给开发者自行完成，比起</span></div>
<div style="position:absolute;top:340;left:125"><span class="ft4">ListView、GridView等控件定制性更强。然而这也不可避免地增加了代码量，</span></div>
<div style="position:absolute;top:360;left:125"><span class="ft4">比如实现一个RecyclerView需要一下几步操作。虽然这里只有四行，但也只是</span></div>
<div style="position:absolute;top:381;left:125"><span class="ft4">最最核心的四行，真正的实现行数可能高达四位数呢。</span></div>
<div style="position:absolute;top:402;left:125"><span class="ft5">messageRecycler</span></div>
<div style="position:absolute;top:402;left:244"><span class="ft6">=</span></div>
<div style="position:absolute;top:402;left:256"><span class="ft6">(RecyclerView)</span></div>
<div style="position:absolute;top:402;left:360"><span class="ft6">findViewById(R.id.</span></div>
<div style="position:absolute;top:402;left:485"><span class="ft7">messagesRecycler</span></div>
<div style="position:absolute;top:402;left:606"><span class="ft6">)</span></div>
<div style="position:absolute;top:402;left:611"><span class="ft8">;</span></div>
<div style="position:absolute;top:423;left:125"><span class="ft5">messageRecycler</span></div>
<div style="position:absolute;top:423;left:240"><span class="ft6">.setLayoutManager(</span></div>
<div style="position:absolute;top:423;left:376"><span class="ft8">new</span></div>
<div style="position:absolute;top:423;left:409"><span class="ft6">LinearLayoutManager(</span></div>
<div style="position:absolute;top:423;left:562"><span class="ft8">this</span></div>
<div style="position:absolute;top:423;left:587"><span class="ft6">))</span></div>
<div style="position:absolute;top:423;left:597"><span class="ft8">;</span></div>
<div style="position:absolute;top:444;left:125"><span class="ft5">messageRecycler</span></div>
<div style="position:absolute;top:444;left:240"><span class="ft6">.setItemAnimator(</span></div>
<div style="position:absolute;top:444;left:365"><span class="ft8">new</span></div>
<div style="position:absolute;top:444;left:398"><span class="ft6">DefaultItemAnimator())</span></div>
<div style="position:absolute;top:444;left:558"><span class="ft8">;</span></div>
<div style="position:absolute;top:465;left:125"><span class="ft5">messageRecycler</span></div>
<div style="position:absolute;top:465;left:240"><span class="ft6">.setAdapter(</span></div>
<div style="position:absolute;top:465;left:325"><span class="ft5">adapter</span></div>
<div style="position:absolute;top:465;left:378"><span class="ft6">)</span></div>
<div style="position:absolute;top:465;left:383"><span class="ft8">;</span></div>
<div style="position:absolute;top:502;left:158"><span class="ft4">第一行找到该View，第二行设置一个布局管理器。这里我们编写一个聊天</span></div>
<div style="position:absolute;top:523;left:125"><span class="ft4">&frac12;面，所以用线性布局的管理器即可。第三行设置的是元素增删的动画，使用系</span></div>
<div style="position:absolute;top:544;left:125"><span class="ft4">统默认的即可。系统默认的动画&frac12;为简&frac12;，并且十分符合MaterialDesign风格，</span></div>
<div style="position:absolute;top:565;left:125"><span class="ft4">而且自行编写工作量也很大，系统自带的简&frac12;动画代码655行，自行实现难度</span></div>
<div style="position:absolute;top:585;left:125"><span class="ft4">可见一斑。最后一行是设置适配器。这个adapter是我自行定义的适配器，源</span></div>
<div style="position:absolute;top:606;left:125"><span class="ft4">代码&frac12;在下文中提到。</span></div>
<div style="position:absolute;top:627;left:158"><span class="ft4">先&frac12;布局吧。由于RecyclerView的元素不能设置靠左靠右，于是我做了一</span></div>
<div style="position:absolute;top:648;left:125"><span class="ft4">些处理。这是原本的代码：</span></div>
<div style="position:absolute;top:690;left:125"><span class="ft9">&lt;android.support.v7.widget.CardView</span></div>
<div style="position:absolute;top:710;left:158"><span class="ft5">app</span></div>
<div style="position:absolute;top:710;left:183"><span class="ft10">:cardCornerRadius=</span></div>
<div style="position:absolute;top:710;left:317"><span class="ft11">&quot;@dimen/myMessageCornerRadius&quot;</span></div>
<div style="position:absolute;top:731;left:158"><span class="ft5">app</span></div>
<div style="position:absolute;top:731;left:183"><span class="ft10">:cardElevation=</span></div>
<div style="position:absolute;top:731;left:288"><span class="ft11">&quot;3dp&quot;</span></div>
<div style="position:absolute;top:752;left:158"><span class="ft5">android</span></div>
<div style="position:absolute;top:752;left:210"><span class="ft10">:id=</span></div>
<div style="position:absolute;top:752;left:236"><span class="ft11">&quot;@+id/messageCard&quot;</span></div>
<div style="position:absolute;top:773;left:158"><span class="ft5">tools</span></div>
<div style="position:absolute;top:773;left:191"><span class="ft10">:layout_margin=</span></div>
<div style="position:absolute;top:773;left:302"><span class="ft11">&quot;@dimen/messageToSurround&quot;</span></div>
<div style="position:absolute;top:794;left:158"><span class="ft5">tools</span></div>
<div style="position:absolute;top:794;left:191"><span class="ft10">:layout_gravity=</span></div>
<div style="position:absolute;top:794;left:301"><span class="ft11">&quot;end&quot;</span></div>
<div style="position:absolute;top:815;left:158"><span class="ft5">android</span></div>
<div style="position:absolute;top:815;left:210"><span class="ft10">:layout_width=</span></div>
<div style="position:absolute;top:815;left:313"><span class="ft11">&quot;wrap_content&quot;</span></div>
<div style="position:absolute;top:835;left:158"><span class="ft5">android</span></div>
<div style="position:absolute;top:835;left:210"><span class="ft10">:layout_height=</span></div>
<div style="position:absolute;top:835;left:317"><span class="ft11">&quot;wrap_content&quot;</span></div>
<div style="position:absolute;top:835;left:426"><span class="ft9">&gt;</span></div>
<div style="position:absolute;top:877;left:158"><span class="ft9">&lt;TextView</span></div>
<div style="position:absolute;top:898;left:191"><span class="ft5">tools</span></div>
<div style="position:absolute;top:898;left:225"><span class="ft10">:text=</span></div>
<div style="position:absolute;top:898;left:264"><span class="ft11">&quot;@string/hello&quot;</span></div>
<div style="position:absolute;top:919;left:191"><span class="ft5">android</span></div>
<div style="position:absolute;top:919;left:244"><span class="ft10">:id=</span></div>
<div style="position:absolute;top:919;left:269"><span class="ft11">&quot;@+id/messageText&quot;</span></div>
<div style="position:absolute;top:940;left:191"><span class="ft5">android</span></div>
<div style="position:absolute;top:940;left:244"><span class="ft10">:layout_margin=</span></div>
<div style="position:absolute;top:940;left:355"><span class="ft11">&quot;@dimen/myMessageMargin&quot;</span></div>
<div style="position:absolute;top:960;left:191"><span class="ft5">android</span></div>
<div style="position:absolute;top:960;left:244"><span class="ft10">:textSize=</span></div>
<div style="position:absolute;top:960;left:310"><span class="ft11">&quot;20sp&quot;</span></div>
<div style="position:absolute;top:981;left:191"><span class="ft5">android</span></div>
<div style="position:absolute;top:981;left:244"><span class="ft10">:layout_width=</span></div>
<div style="position:absolute;top:981;left:346"><span class="ft11">&quot;wrap_content&quot;</span></div>
<div style="position:absolute;top:1002;left:191"><span class="ft5">android</span></div>
<div style="position:absolute;top:1002;left:244"><span class="ft10">:layout_height=</span></div>
<div style="position:absolute;top:1002;left:350"><span class="ft11">&quot;wrap_content&quot;</span></div>
<div style="position:absolute;top:1002;left:463"><span class="ft9">/&gt;</span></div>
<div style="position:absolute;top:1044;left:125"><span class="ft9">&lt;/android.support.v7.widget.CardView&gt;</span></div>
<script TYPE="text/javascript">
			var currentZoom = parent.ltop.currentZoom;
			if(currentZoom != undefined)
				document.body.style.zoom=currentZoom/100;
			</script>
</body>
</html>